Solved by using Topological sort
